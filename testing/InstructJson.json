{
  "name": "ModularBubbleSort",
  "description": "Модульная пузырьковая сортировка с функциями",
  "structureType": "array",
  "variables": [
    {
      "name": "i",
      "type": "int",
      "initialValue": "0"
    },
    {
      "name": "j",
      "type": "int",
      "initialValue": "0"
    },
    {
      "name": "n",
      "type": "int",
      "initialValue": "array_length"
    },
    {
      "name": "swapped",
      "type": "bool",
      "initialValue": "false"
    }
  ],
  "functions": [
    {
      "name": "bubble_pass",
      "description": "Один проход пузырьковой сортировки",
      "parameters": [ "current_i" ],
      "entryPoint": "init_j",
      "steps": [
        {
          "id": "init_j",
          "type": "assign",
          "description": "Инициализация внутреннего цикла",
          "parameters": [ "j", "0" ],
          "nextStep": "inner_loop_condition"
        },
        {
          "id": "inner_loop_condition",
          "type": "condition",
          "description": "Проверка условия внутреннего цикла",
          "parameters": [ "j < n - current_i - 1" ],
          "conditionCases": [
            {
              "condition": "true",
              "nextStep": "compare_neighbors"
            },
            {
              "condition": "false",
              "nextStep": "return_from_pass"
            }
          ]
        },
        {
          "id": "compare_neighbors",
          "type": "compare",
          "description": "Сравнение соседних элементов",
          "parameters": [ "j", "j+1" ],
          "nextStep": "check_swap"
        },
        {
          "id": "check_swap",
          "type": "condition",
          "description": "Проверка необходимости обмена",
          "parameters": [ "last_comparison > 0" ],
          "conditionCases": [
            {
              "condition": "true",
              "nextStep": "swap_elements"
            },
            {
              "condition": "false",
              "nextStep": "increment_j"
            }
          ]
        },
        {
          "id": "swap_elements",
          "type": "swap",
          "description": "Обмен элементов",
          "parameters": [ "j", "j+1" ],
          "nextStep": "set_swapped"
        },
        {
          "id": "set_swapped",
          "type": "assign",
          "description": "Установка флага обмена",
          "parameters": [ "swapped", "true" ],
          "nextStep": "increment_j"
        },
        {
          "id": "increment_j",
          "type": "assign",
          "description": "Увеличение счетчика",
          "parameters": [ "j", "j+1" ],
          "nextStep": "inner_loop_condition"
        },
        {
          "id": "return_from_pass",
          "type": "return",
          "description": "Возврат из прохода"
        }
      ]
    }
  ],
  "steps": [
    {
      "id": "start",
      "type": "assign",
      "description": "Инициализация переменных",
      "parameters": [ "i", "0" ],
      "nextStep": "outer_loop_condition"
    },
    {
      "id": "outer_loop_condition",
      "type": "condition",
      "description": "Проверка условия внешнего цикла",
      "parameters": [ "i < n-1" ],
      "conditionCases": [
        {
          "condition": "true",
          "nextStep": "reset_swapped"
        },
        {
          "condition": "false",
          "nextStep": "end"
        }
      ]
    },
    {
      "id": "reset_swapped",
      "type": "assign",
      "description": "Сброс флага обмена",
      "parameters": [ "swapped", "false" ],
      "nextStep": "call_bubble_pass"
    },
    {
      "id": "call_bubble_pass",
      "type": "call_function",
      "description": "Выполнение одного прохода сортировки",
      "functionName": "bubble_pass",
      "functionParameters": {
        "current_i": "i"
      },
      "returnToStep": "check_early_exit",
      "nextStep": ""
    },
    {
      "id": "check_early_exit",
      "type": "condition",
      "description": "Проверка досрочного завершения",
      "parameters": [ "swapped == false" ],
      "conditionCases": [
        {
          "condition": "true",
          "nextStep": "end"
        },
        {
          "condition": "false",
          "nextStep": "increment_i"
        }
      ]
    },
    {
      "id": "increment_i",
      "type": "assign",
      "description": "Увеличение счетчика внешнего цикла",
      "parameters": [ "i", "i+1" ],
      "nextStep": "outer_loop_condition"
    },
    {
      "id": "end",
      "type": "generic",
      "operation": "complete",
      "description": "Сортировка завершена"
    }
  ]
}