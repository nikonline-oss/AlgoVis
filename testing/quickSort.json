{
  "name": "IterativeQuickSort",
  "description": "Быстрая сортировка с использованием стека",
  "structureType": "array",
  "variables": [
    {
      "name": "low",
      "type": "int",
      "initialValue": 0
    },
    {
      "name": "high",
      "type": "int",
      "initialValue": "array_length-1"
    },
    {
      "name": "i",
      "type": "int",
      "initialValue": 0
    },
    {
      "name": "j",
      "type": "int",
      "initialValue": 0
    },
    {
      "name": "pivot",
      "type": "int",
      "initialValue": 0
    },
    {
      "name": "pivot_index",
      "type": "int",
      "initialValue": 0
    },
    {
      "name": "stack_low",
      "type": "array",
      "initialValue": "100",
      "arraySize": 100
    },
    {
      "name": "stack_high",
      "type": "array",
      "initialValue": "100",
      "arraySize": 100
    },
    {
      "name": "stack_size",
      "type": "int",
      "initialValue": 0
    },
    {
      "name": "stack_capacity",
      "type": "int",
      "initialValue": "100"
    }
  ],
  "functions": [
    {
      "name": "push_to_stack",
      "description": "Добавление границ в стек",
      "parameters": [ "low_val", "high_val" ],
      "entryPoint": "check_stack_overflow",
      "steps": [
        {
          "id": "check_stack_overflow",
          "type": "condition",
          "description": "Проверка переполнения стека",
          "parameters": [ "stack_size < stack_capacity" ],
          "conditionCases": [
            {
              "condition": "true",
              "nextStep": "store_low"
            },
            {
              "condition": "false",
              "nextStep": "stack_overflow_error"
            }
          ],
          "visualize": false
        },
        {
          "id": "store_low",
          "type": "assign",
          "description": "Сохранение нижней границы",
          "parameters": [ "stack_low[stack_size]", "low_val" ],
          "nextStep": "store_high",
          "visualize": false
        },
        {
          "id": "store_high",
          "type": "assign",
          "description": "Сохранение верхней границы",
          "parameters": [ "stack_high[stack_size]", "high_val" ],
          "nextStep": "increment_stack",
          "visualize": false
        },
        {
          "id": "increment_stack",
          "type": "assign",
          "description": "Увеличение размера стека",
          "parameters": [ "stack_size", "stack_size+1" ],
          "nextStep": "return_from_push",
          "visualize": false
        },
        {
          "id": "stack_overflow_error",
          "type": "generic",
          "operation": "error",
          "description": "Переполнение стека",
          "nextStep": "return_from_push",
          "visualize": false
        },
        {
          "id": "return_from_push",
          "type": "return",
          "description": "Возврат из функции push",
          "visualize": false
        }
      ]
    },
    {
      "name": "pop_from_stack",
      "description": "Извлечение границ из стека",
      "parameters": [],
      "entryPoint": "check_stack_empty",
      "steps": [
        {
          "id": "check_stack_empty",
          "type": "condition",
          "description": "Проверка пустоты стека",
          "parameters": [ "stack_size > 0" ],
          "conditionCases": [
            {
              "condition": "true",
              "nextStep": "load_low"
            },
            {
              "condition": "false",
              "nextStep": "stack_empty_error"
            }
          ],
          "visualize": false
        },
        {
          "id": "load_low",
          "type": "assign",
          "description": "Загрузка нижней границы",
          "parameters": [ "low", "stack_low[stack_size-1]" ],
          "nextStep": "load_high",
          "visualize": false
        },
        {
          "id": "load_high",
          "type": "assign",
          "description": "Загрузка верхней границы",
          "parameters": [ "high", "stack_high[stack_size-1]" ],
          "nextStep": "decrement_stack",
          "visualize": false
        },
        {
          "id": "decrement_stack",
          "type": "assign",
          "description": "Уменьшение размера стека",
          "parameters": [ "stack_size", "stack_size-1" ],
          "nextStep": "return_from_pop",
          "visualize": false
        },
        {
          "id": "stack_empty_error",
          "type": "generic",
          "operation": "error",
          "description": "Стек пуст",
          "nextStep": "return_from_pop",
          "visualize": false
        },
        {
          "id": "return_from_pop",
          "type": "return",
          "description": "Возврат из функции pop",
          "visualize": false
        }
      ]
    },
    {
      "name": "partition",
      "description": "Разделение массива относительно опорного элемента",
      "parameters": [ "low_param", "high_param" ],
      "entryPoint": "init_variables",
      "steps": [
        {
          "id": "init_variables",
          "type": "assign",
          "description": "Инициализация переменных раздела",
          "parameters": [ "pivot", "array[high_param]" ],
          "nextStep": "init_i",
          "visualize": false
        },
        {
          "id": "init_i",
          "type": "assign",
          "description": "Инициализация индекса i",
          "parameters": [ "i", "low_param-1" ],
          "nextStep": "init_j",
          "visualize": false
        },
        {
          "id": "init_j",
          "type": "assign",
          "description": "Инициализация индекса j",
          "parameters": [ "j", "low_param" ],
          "nextStep": "partition_loop_condition",
          "visualize": false
        },
        {
          "id": "partition_loop_condition",
          "type": "condition",
          "description": "Проверка условия цикла разделения",
          "parameters": [ "j < high_param" ],
          "conditionCases": [
            {
              "condition": "true",
              "nextStep": "compare_element_with_pivot"
            },
            {
              "condition": "false",
              "nextStep": "place_pivot"
            }
          ],
          "visualize": false
        },
        {
          "id": "compare_element_with_pivot",
          "type": "compare",
          "description": "Сравнение элемента array[j] с опорным",
          "parameters": [ "j", "high_param" ],
          "nextStep": "check_if_less_equal",
          "visualize": true,
          "highlightElements": [ "j", "high_param" ],
          "highlightColor": "yellow",
          "visualizationType": "comparison"
        },
        {
          "id": "check_if_less_equal",
          "type": "condition",
          "description": "Проверка, нужно ли переместить элемент",
          "parameters": [ "last_comparison <= 0" ],
          "conditionCases": [
            {
              "condition": "true",
              "nextStep": "increment_i"
            },
            {
              "condition": "false",
              "nextStep": "increment_j"
            }
          ],
          "visualize": false
        },
        {
          "id": "increment_i",
          "type": "assign",
          "description": "Увеличение индекса i",
          "parameters": [ "i", "i+1" ],
          "nextStep": "swap_elements",
          "visualize": false
        },
        {
          "id": "swap_elements",
          "type": "swap",
          "description": "Обмен элементов i и j",
          "parameters": [ "i", "j" ],
          "nextStep": "increment_j",
          "visualize": true,
          "highlightElements": [ "i", "j" ],
          "highlightColor": "red",
          "visualizationType": "swap"
        },
        {
          "id": "increment_j",
          "type": "assign",
          "description": "Переход к следующему элементу",
          "parameters": [ "j", "j+1" ],
          "nextStep": "partition_loop_condition",
          "visualize": false
        },
        {
          "id": "place_pivot",
          "type": "assign",
          "description": "Размещение опорного элемента на правильную позицию",
          "parameters": [ "pivot_index", "i+1" ],
          "nextStep": "swap_pivot",
          "visualize": false
        },
        {
          "id": "swap_pivot",
          "type": "swap",
          "description": "Обмен опорного элемента с позицией i+1",
          "parameters": [ "pivot_index", "high_param" ],
          "nextStep": "return_partition",
          "visualize": true,
          "highlightElements": [ "pivot_index", "high_param" ],
          "highlightColor": "purple",
          "visualizationType": "pivot_placement"
        },
        {
          "id": "return_partition",
          "type": "return",
          "description": "Возврат из функции разделения",
          "visualize": false
        }
      ]
    }
  ],
  "steps": [
    {
      "id": "start",
      "type": "call_function",
      "description": "Добавление начальных границ в стек",
      "functionName": "push_to_stack",
      "functionParameters": {
        "low_val": "0",
        "high_val": "array_length-1"
      },
      "returnToStep": "main_loop_condition",
      "visualize": false
    },
    {
      "id": "main_loop_condition",
      "type": "condition",
      "description": "Проверка, есть ли элементы в стеке",
      "parameters": [ "stack_size > 0" ],
      "conditionCases": [
        {
          "condition": "true",
          "nextStep": "pop_from_stack"
        },
        {
          "condition": "false",
          "nextStep": "end"
        }
      ],
      "visualize": false
    },
    {
      "id": "pop_from_stack",
      "type": "call_function",
      "description": "Извлечение границ из стека",
      "functionName": "pop_from_stack",
      "functionParameters": {},
      "returnToStep": "check_partition_size",
      "visualize": false
    },
    {
      "id": "check_partition_size",
      "type": "condition",
      "description": "Проверка размера раздела",
      "parameters": [ "low < high" ],
      "conditionCases": [
        {
          "condition": "true",
          "nextStep": "call_partition"
        },
        {
          "condition": "false",
          "nextStep": "main_loop_condition"
        }
      ],
      "visualize": false
    },
    {
      "id": "call_partition",
      "type": "call_function",
      "description": "Вызов функции разделения",
      "functionName": "partition",
      "functionParameters": {
        "low_param": "low",
        "high_param": "high"
      },
      "returnToStep": "push_left_partition",
      "visualize": false
    },
    {
      "id": "push_left_partition",
      "type": "call_function",
      "description": "Добавление левого раздела в стек",
      "functionName": "push_to_stack",
      "functionParameters": {
        "low_val": "low",
        "high_val": "pivot_index-1"
      },
      "returnToStep": "push_right_partition",
      "visualize": false
    },
    {
      "id": "push_right_partition",
      "type": "call_function",
      "description": "Добавление правого раздела в стек",
      "functionName": "push_to_stack",
      "functionParameters": {
        "low_val": "pivot_index+1",
        "high_val": "high"
      },
      "returnToStep": "main_loop_condition",
      "visualize": false
    },
    {
      "id": "end",
      "type": "generic",
      "operation": "complete",
      "description": "Сортировка завершена",
      "visualize": true,
      "highlightElements": [],
      "highlightColor": "green",
      "visualizationType": "completion"
    }
  ]
}